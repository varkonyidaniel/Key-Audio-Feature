Bootstrap: docker

From: continuumio/miniconda3

%files
    environment.yml

%post
    /opt/conda/bin/conda update conda
    /opt/conda/bin/conda env create --name KAF --file environment.yml
    /opt/conda/bin/conda update --all -n KAF

%runscript
    exec /opt/conda/envs/$(head -n 1 environment.yml | cut -f 2 -d ' ')/bin/"$@"

Build